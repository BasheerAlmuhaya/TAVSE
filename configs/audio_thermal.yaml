# ─────────────────────────────────────────────────────────────
# TAVSE Config: Audio + Thermal Visual (Model A+T)
# ─────────────────────────────────────────────────────────────
experiment_name: audio_thermal

model:
  active_modalities: ["audio", "thermal"]
  audio_channels: [1, 32, 64, 128, 256, 512]
  audio_bottleneck_dim: 512
  visual_backbone: resnet18
  visual_feat_dim: 512
  gru_hidden: 256
  gru_layers: 2
  fusion_dim: 512
  fusion_heads: 8
  fusion_dropout: 0.1
  fusion_alpha_init: 0.1

audio:
  sample_rate: 16000
  n_fft: 512
  win_length: 400
  hop_length: 160
  segment_seconds: 2.5
  segment_samples: 40000

visual:
  fps: 28
  roi_size: 96
  n_frames_per_segment: 70
  rgb_channels: 3
  thermal_channels: 1

data:
  scratch_base: ${TAVSE_DATA_ROOT}
  rgb_lmdb_path: ${TAVSE_DATA_ROOT}/processed/rgb_mouth.lmdb
  thermal_lmdb_path: ${TAVSE_DATA_ROOT}/processed/thermal_mouth.lmdb
  audio_dir: ${TAVSE_DATA_ROOT}/processed/audio_16k
  noise_dir: ${TAVSE_DATA_ROOT}/processed/noise
  metadata_dir: ${TAVSE_DATA_ROOT}/processed/metadata
  train_manifest: ${TAVSE_DATA_ROOT}/processed/metadata/train_manifest.csv
  val_manifest: ${TAVSE_DATA_ROOT}/processed/metadata/val_manifest.csv
  test_manifest: ${TAVSE_DATA_ROOT}/processed/metadata/test_manifest.csv
  train_snr_range: [-5.0, 0.0, 5.0, 10.0, 15.0]
  test_snr_levels: [-5.0, 0.0, 5.0, 10.0]

training:
  batch_size: 16
  num_workers: 4
  pin_memory: true
  persistent_workers: true
  prefetch_factor: 2
  optimizer: adamw
  lr: 3.0e-4
  weight_decay: 0.01
  betas: [0.9, 0.999]
  warmup_steps: 2000
  max_epochs: 100
  loss_si_snr_weight: 1.0
  loss_mag_weight: 0.1
  patience: 10
  use_amp: true
  grad_accum_steps: 1
  checkpoint_dir: ${TAVSE_DATA_ROOT}/checkpoints
  keep_top_k: 3
  log_dir: ${TAVSE_DATA_ROOT}/logs
  log_interval: 50
  val_interval: 1
  seed: 42
